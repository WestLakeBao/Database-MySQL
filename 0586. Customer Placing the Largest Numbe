0586. Customer Placing the Largest Number of Orders

-- Query the customer_number from the orders table for the customer who has placed the largest number of orders.

-- It is guaranteed that exactly one customer will have placed more orders than any other customer.

-- Sample Input
-- | order_number | customer_number | order_date | required_date | shipped_date | status | comment |
-- |--------------|-----------------|------------|---------------|--------------|--------|---------|
-- | 1            | 1               | 2017-04-09 | 2017-04-13    | 2017-04-12   | Closed |         |
-- | 2            | 2               | 2017-04-15 | 2017-04-20    | 2017-04-18   | Closed |         |
-- | 3            | 3               | 2017-04-16 | 2017-04-25    | 2017-04-20   | Closed |         |
-- | 4            | 3               | 2017-04-18 | 2017-04-28    | 2017-04-25   | Closed |         |

-- Sample Output
-- | customer_number |
-- |-----------------|
-- | 3               |

With t1 as (
    select customer_number,
    Rank() over(order by count(customer_number) desc) as rk
    from orders
    group by customer_number
)
select t1.customer_number from t1 where t1.rk = 1;